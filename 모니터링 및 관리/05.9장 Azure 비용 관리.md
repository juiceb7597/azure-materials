#제 9장 Azure 비용 관리(Cost Management)

##개요
- Azure 비용 관리 서비스는 매월 청구되는 모든 리소스에 대한 자세한 비용 분석을 제공하여 조직이 Azure 지출을 더 잘 이해할 수 있도록 도와줍니다. 지출이나 예산을 모니터링하여 지출을 줄이는 알림을 설정할 수 있습니다. 또한 각 리소스에 대해 비용이 어떻게 발생하는지 더 잘 이해하여 지출을 최적화할 수 있습니다. 마지막으로 Cost Management는 지속적인 결제를 담당하는 내부 리소스에 매월 청구서가 자동으로 전송되도록 청구 정보를 설정하는 데 도움이 됩니다.
- 비용 관리 및 청구 구성은 구독 유형에 따라 다릅니다. 이 장에서는 종량제 구독이 있다고 가정합니다. 다른 유형의 구독이 있는 경우 Microsoft 담당자 또는 파트너와 협력하여 사용자 환경에 맞게 구독을 관리하는 방법을 더 잘 이해해야 합니다.

##주요 특징들
- **리소스당 비용의 세부 분석(Analysis) 및 분석(Breakdown)**: Cost Management를 사용하여 이전 달, 이전 분기 또는 사용자 지정 기간 동안 발생한 모든 리소스 및 구독 수준 비용에 대한 세부 분석을 얻을 수 있습니다. 이를 통해 지출을 분석하고 최적화 영역을 식별할 수 있습니다.
- **지출 예산 및 계획**: Cost Management를 사용하면 리소스 및 서비스를 기준으로 월별, 분기별, 연간 지출을 더 잘 이해할 수 있습니다. 이는 향후 확장 또는 리소스 확장 활동에 대한 예산을 책정하고 지출을 계획하는 데 도움이 될 수 있습니다.
- **지출을 추적하고 모니터링하도록 경고 설정**: 예산에 도달하거나 초과할 때 알림을 받도록 Cost Management에서 경고를 설정할 수 있습니다. 이를 통해 비용을 계획 및 관리하고, 계획되지 않은 지출로 인해 발생하는 문제를 해결하기 위한 사전 조치를 취할 수 있습니다.
- **자동화된 분석 및 작업을 위해 타사 솔루션과 통합**: Cost Management를 타사 솔루션과 통합하여 계획된 지출 및 지출을 줄이기 위한 최적화 영역에서 벗어나는 워크로드 지출을 자동으로 분류하고 분석할 수 있습니다.

##설계 및 배포 개념과 고려 사항
비용 계획(Cost Planning)
- 구조화된 접근 방식을 사용하여 Azure 지출을 계획하면 월말에 계획되지 않은 대규모 청구서가 도착하는 것을 방지할 수 있습니다. 계획에는 Azure 환경에 설정하려는 모든 워크로드를 식별하고 다음과 같은 다양한 요인을 기반으로 이러한 리소스에 대한 지출을 추정하는 작업이 포함됩니다.
    - 리소스를 호스팅할 지역
    - 각 리소스에 필요한 중복 수준
    - 각 리소스에 필요한 OS 및 기능
    - 예상되는 리소스 가동 시간
    - 가동 중단 시 허용되는 가동 중지 시간
    - 허용되는 데이터 손실 한도
- 이는 전체 요소 목록이 아닙니다. 모든 환경은 고유하며 조직마다 규정 준수 및 예산 압박이 다양합니다. 그러나 이는 계획을 세우는 데 좋은 출발점을 제공합니다.
- 조직과 관련된 다른 요소를 식별하고 계획 결정에 이러한 입력을 포함하십시오.
- Azure 디자인에 영향을 미칠 수 있는 모든 요소를 식별한 후에는 `https://azure.microsoft.com/en-us/pricing/calculator`에서 Azure 계산기를 사용하여 월별 지출 추정치를 생성할 수 있습니다. 이를 출발점으로 삼아 설계 변경, 예산 책정, 실제 지출 대비 향후 상관 관계를 계획하세요.

예산(Budgets)
- 예산 책정은 승인된 지출과 관련하여 내부 리소스에 대한 명확성을 제공하는 데 도움이 될 수 있으며 예산에 맞춰 처음부터 결정해야 할 설계 선택에 영향을 줄 수 있습니다.
- Cost Management를 사용하면 예산을 마련하고, 지출 승인을 기반으로 Azure 리소스에 지출할 다양한 사용자에게 예산을 할당하고, 예산 한도를 초과하는 요금에 대해 다양한 리소스, 구독 및 비즈니스 소유자에게 경고하도록 임계값을 설정할 수 있습니다. 이를 통해 귀하와 귀하의 Azure 관리자는 편차에 대한 정보를 계속 얻을 수 있으며 어떤 워크로드가 계획되지 않은 지출을 유발할 수 있는지에 대한 가시성을 제공합니다.

비용 분석(Cost Analysis)
- 비용 분석 도구는 리소스 및 구독에 대한 청구에 대한 자세한 분석을 제공합니다. 구독 전체의 지출 패턴을 검토하고 리소스 유형, 리소스 그룹, 타임라인 등에 걸쳐 유사한 분석을 얻을 수 있는 다양한 필터와 보기를 제공합니다. Azure Marketplace의 리소스 요금은 별도로 표시되므로 해당 비용을 더 쉽게 식별할 수 있습니다.
- 현재 비용 분석에는 예약, 지원 및 관련 세금에 대한 요금이 표시되지 않습니다.

<img src="https://drive.google.com/uc?id=16COsulhL9zMe1npqrsP_vg6LXtXQRqLu">

- 이 데이터를 다양한 방법으로 내보내고 분석할 수 있습니다.
    - **Azure Storage 계정으로 내보내기**: 추가 분석을 위해 사용량 데이터를 Azure Storage 계정으로 자동 내보내기하도록 예약할 수 있습니다. 시간이 지남에 따라 이 데이터를 수집하면 비용 비교 및 분석 목적으로 Microsoft Excel 및 Power BI와 같은 분석 도구를 사용하는 데 도움이 될 수 있습니다.
    - **Microsoft Excel**: 내보낸 데이터를 Microsoft Excel 내에서 분석하고 필요에 따라 데이터를 필터링하고 정렬할 수 있습니다. 특정 리소스, 리소스 그룹 및 리소스 범주로 드릴다운하여 지출을 더 잘 이해할 수도 있습니다.
    - **Power B**: IPower BI를 사용하면 예산과 실제 지출을 더 잘 이해하기 위해 개별 리소스를 드릴다운할 수 있습니다. Power BI는 내보낸 사용량 데이터를 분석하여 다양한 기간에 걸쳐 지출을 더 깊이 이해하고 철저하게 비교할 수 있는 훌륭한 도구입니다.
    - **Power BI 데이터 커넥터**: Power BI 데이터 커넥터를 설정하여 매일 자동으로 데이터를 Power BI로 직접 전송할 수 있습니다. 이를 통해 자동화된 방식으로 최신 지출 분석이 가능해 더욱 정확한 예측이 가능해집니다.
    - **API 사용**: Microsoft는 분석을 위해 비용 분석에서 타사 솔루션으로 데이터 내보내기 및 통합을 자동화하는 다양한 API를 제공합니다.
- 비용 분석을 설정하여 조직 내의 다양한 개인에게 데이터와 보고서를 자동으로 보낼 수도 있습니다. 예를 들어 구독 및 리소스 그룹에 대한 쓰기 액세스 권한이 있는 직원에게 이를 보내 계획되지 않은 요금을 설명할 수 있는 편차 영역을 식별할 수 있습니다.
- 각 리소스에 대한 감사 로그를 사용하여 지출 급증을 유발할 수 있는 리소스 구성 변경 사항을 식별할 수 있습니다.

고문 추천(Advisor recommendations)
- Cost Management에는 미리 프로그래밍된 비용 최적화 모범 사례를 사용하여 비용을 절감하기 위해 크기를 조정하거나 예약할 수 있는 워크로드를 식별하는 권장 엔진이 있어 조직에서 매년 수백 또는 수천 달러를 절약할 수 있습니다. 이는 각 리소스에 대해 캡처된 유휴 시간 및 사용량 정보를 고려하여 수행됩니다. 권장 사항을 받으면 Cost Management는 권장 사항의 영향 수준을 나타냅니다. 또한 향후 명시된 비용 이점을 달성하기 위해 리소스의 크기를 수동으로 조정, 재배포 또는 재구성하는 방법을 안내합니다.
- 분석, 내부 토론, 승인을 위해 권장 사항을 CSV 형식으로 다운로드할 수 있습니다. 또한 새로운 권장 사항이 식별되면 이를 인식하도록 경고를 설정하고 미리 결정된 일정에 따라 통합 권장 사항 세트를 얻기 위해 권장 사항 다이제스트를 설정할 수도 있습니다. 이는 검토 및 조치를 위해 관련 이해관계자에게 전송될 수 있습니다. 마지막으로 API를 사용하여 통합 보기를 위해 권장 사항을 타사 솔루션으로 내보낼 수 있습니다.

<img src="https://drive.google.com/uc?id=1UXPmTbA5votnbMhei1sF9SFshK-wl3_u">
